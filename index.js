(()=>{"use strict";var t={863:(t,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.TouchPad=void 0;class e extends HTMLElement{constructor(){super(),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.resizeListener=null,this.highlight=new Image,this.pointerdown=!1,this.prev={x:-1,y:-1},this.inactiveColor="#d3d3d3",this.activeColor="#ff1090",this.analog=!1,this.digitalSectors=8,this.digitalMagnitudes=1,this.subscriptions=[]}connectedCallback(){this.style.display="inline-block",this.canvas.style.borderRadius="50%",this.canvas.style.display="block",this.canvas.style.margin="auto",this.canvas.style.position="relative",this.canvas.style.top="50%",this.canvas.style.transform="translateY(-50%)",this.canvas.style.boxSizing="border-box",this.canvas.style.border="1px solid black",this.inactiveColor=this.hasAttribute("inactive-color")?this.getAttribute("inactive-color"):this.inactiveColor,this.activeColor=this.hasAttribute("active-color")?this.getAttribute("active-color"):this.activeColor,this.analog=this.hasAttribute("analog")?"true"===this.getAttribute("analog"):this.analog,this.digitalSectors=this.hasAttribute("digital-sectors")?parseInt(this.getAttribute("digital-sectors")):this.digitalSectors,this.digitalMagnitudes=this.hasAttribute("digital-magnitudes")?parseInt(this.getAttribute("digital-magnitudes")):this.digitalMagnitudes;let t=document.createElement("canvas");t.width=140,t.height=140;let i=t.getContext("2d"),e=i.createRadialGradient(70,70,5,70,70,70);e.addColorStop(0,"white"),e.addColorStop(1,this.activeColor),i.arc(70,70,60,0,2*Math.PI),i.fillStyle=e,i.fill(),this.highlight.onload=()=>{this.render(),this.draw(0,0),"ResizeObserver"in window?(this.resizeListener=new ResizeObserver((t=>{this.onResize()})),this.resizeListener.observe(this)):(alert("Warning! ResizeObserver not supported by your browser. Touchpad component may not function properly."),window.addEventListener("resize",(()=>this.onResize()))),this.addPointerEvents()||(this.addMouseEvents(),alert("Warning! PointerEvent not supported by your browser. Touchpad component may not function properly."))},this.highlight.src=t.toDataURL("image/png")}calcPointerCoords(t,i){let e={x:t-.5*this.clientWidth,y:i-.5*this.clientHeight},s=.25*(this.canvas.width<this.canvas.height?this.canvas.width:this.canvas.height),h=Math.sqrt(e.x*e.x+e.y*e.y),a=h/s;if(a>1&&(a=1),e.x*=a/h,e.y*=a/h,!this.analog){h=Math.sqrt(e.x*e.x+e.y*e.y);let t=Math.atan2(e.y,e.x);t<0&&(t+=2*Math.PI),t=Math.round(this.digitalSectors*t/(2*Math.PI))*(2*Math.PI)/this.digitalSectors,h=Math.round(this.digitalMagnitudes*h)/this.digitalMagnitudes,e.x=h*Math.cos(t),e.y=h*Math.sin(t)}return e}draw(t,i){if(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.pointerdown){this.ctx.fillStyle=this.activeColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);let e=.25*(this.canvas.width<this.canvas.height?this.canvas.width:this.canvas.height),s=.5*(this.canvas.width<this.canvas.height?this.canvas.width:this.canvas.height),h={x:.5*this.canvas.width+e*t,y:.5*this.canvas.height+e*i};this.ctx.drawImage(this.highlight,h.x-.5*s,h.y-.5*s,s,s)}else this.ctx.fillStyle=this.inactiveColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);this.ctx.fillStyle="darkgrey",this.ctx.strokeStyle="black";let e=Math.cos(Math.PI/4),s=Math.cos(Math.PI/4),h=.25*(this.canvas.width<this.canvas.height?this.canvas.width:this.canvas.height),a=.5*(this.canvas.width<this.canvas.height?this.canvas.width:this.canvas.height),n=[{x:a-.5*h,y:.25*h},{x:a-.5*h,y:-.25*h},{x:.9*a,y:0}];for(let t=0;t<8;t++)this.ctx.beginPath(),this.ctx.moveTo(n[0].x+.5*this.canvas.width,n[0].y+.5*this.canvas.height),this.ctx.lineTo(n[1].x+.5*this.canvas.width,n[1].y+.5*this.canvas.height),this.ctx.lineTo(n[2].x+.5*this.canvas.width,n[2].y+.5*this.canvas.height),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke(),n.forEach((t=>{let i=t.x*e-t.y*s,h=t.x*s+t.y*e;t.x=i,t.y=h}))}onResize(){this.clientWidth<this.clientHeight?(this.canvas.style.width="100%",this.canvas.style.height=(this.canvas.clientWidth+2).toString()+"px",this.canvas.style.width=this.canvas.clientHeight.toString()+"px"):(this.canvas.style.height="100%",this.canvas.style.width=(this.canvas.clientHeight+2).toString()+"px",this.canvas.style.height=this.canvas.clientWidth.toString()+"px"),this.canvas.width=this.canvas.clientWidth,this.canvas.height=this.canvas.width,this.draw(0,0)}addPointerEvents(){return"PointerEvent"in window&&(this.addEventListener("pointerdown",(t=>{this.pointerdown=!0;let i={x:t.clientX-this.getBoundingClientRect().left,y:t.clientY-this.getBoundingClientRect().top},e=this.calcPointerCoords(i.x,i.y);e.x===this.prev.x&&e.y===this.prev.y||(this.prev.x=e.x,this.prev.y=e.y,this.draw(e.x,e.y),this.subscriptions.forEach((t=>{t&&t(e.x,-e.y)})))})),this.addEventListener("pointerup",(t=>{this.pointerdown=!1,this.prev.x=-1,this.prev.y=-1,this.draw(0,0),this.subscriptions.forEach((t=>{t&&t(0,0)}))})),this.addEventListener("pointermove",(t=>{if(this.pointerdown){let i={x:t.clientX-this.getBoundingClientRect().left,y:t.clientY-this.getBoundingClientRect().top},e=this.calcPointerCoords(i.x,i.y);e.x===this.prev.x&&e.y===this.prev.y||(this.prev.x=e.x,this.prev.y=e.y,this.draw(e.x,e.y),this.subscriptions.forEach((t=>{t&&t(e.x,-e.y)})))}})),this.addEventListener("pointerleave",(t=>{this.pointerdown&&(this.pointerdown=!1,this.prev.x=-1,this.prev.y=-1,this.draw(0,0),this.subscriptions.forEach((t=>{t&&t(0,0)})))})),!0)}addMouseEvents(){return"TouchEvent"in window&&(this.addEventListener("mousedown",(t=>{this.pointerdown=!0;let i={x:t.clientX-this.getBoundingClientRect().left,y:t.clientY-this.getBoundingClientRect().top},e=this.calcPointerCoords(i.x,i.y);e.x===this.prev.x&&e.y===this.prev.y||(this.prev.x=e.x,this.prev.y=e.y,this.draw(e.x,e.y),this.subscriptions.forEach((t=>{t&&t(e.x,-e.y)})))})),this.addEventListener("mouseup",(t=>{this.pointerdown=!1,this.prev.x=-1,this.prev.y=-1,this.draw(0,0),this.subscriptions.forEach((t=>{t&&t(0,0)}))})),this.addEventListener("mousemove",(t=>{if(this.pointerdown){let i={x:t.clientX-this.getBoundingClientRect().left,y:t.clientY-this.getBoundingClientRect().top},e=this.calcPointerCoords(i.x,i.y);e.x===this.prev.x&&e.y===this.prev.y||(this.prev.x=e.x,this.prev.y=e.y,this.draw(e.x,e.y),this.subscriptions.forEach((t=>{t&&t(e.x,-e.y)})))}})),this.addEventListener("mouseleave",(t=>{this.pointerdown&&(this.pointerdown=!1,this.prev.x=-1,this.prev.y=-1,this.draw(0,0),this.subscriptions.forEach((t=>{t&&t(0,0)})))})),!0)}render(){this.appendChild(this.canvas)}subscribe(t){return this.subscriptions.push(t),this.subscriptions.length-1}unsubscribe(t){this.subscriptions[t]=null}}i.TouchPad=e},4:(t,i,e)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Ball=void 0;const s=e(845);i.Ball=class{constructor(t,i,e,h,a,n){this.applyForce=t=>{this.acceleration.add(t.scaled(1/this.mass))},this.location=t,this.velocity=new s.Edge2D(this.location,i,{directed:!0,color:4278190335}),this.acceleration=new s.Edge2D(this.location,e,{directed:!0,color:4278255615}),this.radius=h,this.mass=a,this.attributes=Object.assign({},n)}getLocation(){return{x:this.location.x,y:this.location.y}}relocate(t,i){let e=t-this.location.x,s=i-this.location.y,h=this.velocity.x(),a=this.velocity.y(),n=this.acceleration.x(),o=this.acceleration.y();return this.location.x+=e,this.location.y+=s,this.velocity.setP2({x:this.location.x+h,y:this.location.y+a}),this.acceleration.setP2({x:this.location.x+n,y:this.location.y+o}),this}getRadius(){return this.radius}move(t){this.relocate(this.location.x+t*this.velocity.x(),this.location.y+t*this.velocity.y()),this.velocity.add(this.acceleration.scaled(t))}timeToCollideWithEdge(t){let i=new s.Edge2D({x:this.location.x,y:this.location.y},{x:this.location.x+this.velocity.x(),y:this.location.y+this.velocity.y()}),e=new s.Edge2D(t.p1,this.location).det(t),h=t.det(i),a=this.radius*t.m(),n=999999,o=999999;0!=h&&(n=(e+a)/h,o=(e-a)/h);let r=t.m(),c=1/r;if(n<0||n>999999)n=999999;else{let i=this.location.x+n*this.velocity.x(),e=this.location.y+n*this.velocity.y(),s=((i-t.getP1().x)*t.x()+(e-t.getP1().y)*t.y())*c;(s<0||s>r)&&(n=9999999)}if(o<0||o>999999)o=999999;else{let i=this.location.x+o*this.velocity.x(),e=this.location.y+o*this.velocity.y(),s=((i-t.getP1().x)*t.x()+(e-t.getP1().y)*t.y())*c;(s<0||s>r)&&(o=9999999)}return[n,o]}timeToCollideWithBall(t){var i=this.velocity.x(),e=this.velocity.y(),s=t.velocity.x(),h=t.velocity.y(),a=this.location.x-t.location.x,n=this.location.y-t.location.y,o=i-s,r=e-h,c=o*o+r*r,l=2*(a*o+n*r),y=l*l-4*c*(a*a+n*n-(this.radius+t.radius)*(this.radius+t.radius));return y<0||0===c?[999999999,99999999]:[(-l-Math.sqrt(y))/(2*c),(-l+Math.sqrt(y))/(2*c)]}timeToCollideWithPoint(t){var i=this.velocity.x(),e=this.velocity.y(),s=this.location.x-t.x,h=this.location.y-t.y,a=i*i+e*e,n=2*(s*i+h*e),o=n*n-4*a*(s*s+h*h-this.radius*this.radius);return o<0||0===a?[999999999,99999999]:[(-n-Math.sqrt(o))/(2*a),(-n+Math.sqrt(o))/(2*a)]}deflectWithEdge(t){let i=new s.Edge2D({x:this.location.x,y:this.location.y},{x:this.location.x+this.velocity.x(),y:this.location.y+this.velocity.y()}),e=t.mm(),h=new s.Edge2D(this.location,{x:-2*t.y()*i.det(t)/e,y:2*t.x()*i.det(t)/e});this.velocity.add(h)}slideOnEdge(t){let i=this.velocity.rejected(t);i.clip2(t),i.size(-.1),this.relocate(i.getP2().x,i.getP2().y);let e=this.velocity.projected(t);this.velocity.p2.x=this.velocity.p1.x+e.x(),this.velocity.p2.y=this.velocity.p1.y+e.y()}deflectWithBall(t){let i=new s.Edge2D(this.location,t.location),e=this.velocity.rejected(i),h=t.velocity.rejected(i),a=this.velocity.projectedScalar(i),n=t.velocity.projectedScalar(i),o=(2*t.mass*n+a*(this.mass-t.mass))/(this.mass+t.mass),r=(2*this.mass*a+n*(t.mass-this.mass))/(this.mass+t.mass),c=i.sized(o).add(e),l=i.sized(r).add(h);this.velocity.p2.x=this.velocity.p1.x+c.x(),this.velocity.p2.y=this.velocity.p1.y+c.y(),t.velocity.p2.x=t.velocity.p1.x+l.x(),t.velocity.p2.y=t.velocity.p1.y+l.y()}deflectWithPoint(t){let i=new s.Edge2D(this.location,t),e=this.velocity.projected(i),h=this.velocity.rejected(i).add(e.scaled(-1));this.velocity.p2.x=this.velocity.p1.x+h.x(),this.velocity.p2.y=this.velocity.p1.y+h.y()}}},845:(t,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Edge2D=void 0;class e{constructor(t,i,e){this.attributes={},this.p1=t,this.p2=i,this.attributes=Object.assign(Object.assign({},this.attributes),e)}x(){return this.p2.x-this.p1.x}y(){return this.p2.y-this.p1.y}getP1(){return{x:this.p1.x,y:this.p1.y}}getP2(){return{x:this.p2.x,y:this.p2.y}}setP1(t){return this.p1.x=t.x,this.p1.y=t.y,this}setP2(t){return this.p2.x=t.x,this.p2.y=t.y,this}m(){return Math.sqrt(this.mm())}mm(){return this.x()*this.x()+this.y()*this.y()}t(){let t=Math.atan2(this.y(),this.x());return t<0&&(t+=2*Math.PI),t}dot(t){return this.x()*t.x()+this.y()*t.y()}det(t){return this.x()*t.y()-this.y()*t.x()}projectedScalar(t){return this.dot(t)/t.m()}rejectedScalar(t){return this.det(t)/t.m()}getParametricPoint(t){return{x:this.p1.x+t*this.x(),y:this.p1.y+t*this.y()}}getParametricIntersection(t){let i=this.det(t);return i?(t.y()*(t.p1.x-this.p1.x)-t.x()*(t.p1.y-this.p1.y))/i:null}reposition(t){let i=this.x(),e=this.y();return this.p1.x=t.x,this.p1.y=t.y,this.p2.x=this.p1.x+i,this.p2.y=this.p1.y+e,this}repositioned(t){return new e({x:t.x,y:t.y},{x:t.x+this.x(),y:t.y+this.y()},Object.assign({},this.attributes))}scale(t){return this.p2.x=this.p1.x+t*this.x(),this.p2.y=this.p1.y+t*this.y(),this}scaled(t){return new e({x:this.p1.x,y:this.p1.y},{x:this.p1.x+t*this.x(),y:this.p1.y+t*this.y()},Object.assign({},this.attributes))}size(t){return this.scale(1/this.m()).scale(t)}sized(t){return new e({x:this.p1.x,y:this.p1.y},{x:this.p2.x,y:this.p2.y},Object.assign({},this.attributes)).scale(1/this.m()).scale(t)}angle(t){let i=this.m();return this.p2.x=this.p1.x+i*Math.cos(t),this.p2.y=this.p1.y+i*Math.sin(t),this}angled(t){let i=this.m();return new e({x:this.p1.x,y:this.p1.y},{x:this.p1.x+i*Math.cos(t),y:this.p1.y+i*Math.sin(t)},Object.assign({},this.attributes))}rotate(t){let i=Math.cos(t),e=Math.sin(t),s=this.x(),h=this.y();return this.p2.x=this.p1.x+s*i-h*e,this.p2.y=this.p1.y+s*e+h*i,this}rotated(t){let i=Math.cos(t),s=Math.sin(t),h=this.x(),a=this.y();return new e({x:this.p1.x,y:this.p1.y},{x:this.p1.x+h*i-a*s,y:this.p1.y+h*s+a*i},Object.assign({},this.attributes))}pivot(t,i){let e=Math.cos(t),s=Math.sin(t),h=this.p1.x-i.x,a=this.p1.y-i.y,n=this.p2.x-i.x,o=this.p2.y-i.y;return this.p1.x=i.x+h*e-a*s,this.p1.y=i.y+h*s+a*e,this.p2.x=i.x+n*e-o*s,this.p2.y=i.y+n*s+o*e,this}pivoted(t,i){return new e({x:this.p1.x,y:this.p1.y},{x:this.p2.x,y:this.p2.y},Object.assign({},this.attributes)).pivot(t,i)}add(t){return this.p2.x+=t.x(),this.p2.y+=t.y(),this}added(t){return new e({x:this.p1.x,y:this.p1.y},{x:this.p2.x+=t.x(),y:this.p2.y+=t.y()},Object.assign({},this.attributes))}project(t){let i=this.dot(t)/t.mm();return this.p2.x=this.p1.x+i*t.x(),this.p2.y=this.p1.y+i*t.y(),this}projected(t){let i=this.dot(t)/t.mm();return new e({x:this.p1.x,y:this.p1.y},{x:this.p1.x+i*t.x(),y:this.p1.y+i*t.y()},Object.assign({},this.attributes))}reject(t){this.projected(t);let i=this.det(t)/t.mm();return this.p2.x=this.p1.x+i*t.y(),this.p2.y=this.p1.y-i*t.x(),this}rejected(t){this.projected(t);let i=this.det(t)/t.mm();return new e({x:this.p1.x,y:this.p1.y},{x:this.p1.x+ +i*t.y(),y:this.p1.y-i*t.x()},Object.assign({},this.attributes))}intersection(t){return(-t.y()*(t.p1.x-this.p1.x)+t.x()*(t.p1.y-this.p1.y))/t.det(this)}clip1(t){let i=this.intersection(t);return isFinite(i)&&i>0&&i<1&&(this.p1.x=this.p1.x+i*(this.p2.x-this.p1.x),this.p1.y=this.p1.y+i*(this.p2.y-this.p1.y)),this}clipped1(t){return new e({x:this.p1.x,y:this.p1.y},{x:this.p2.x,y:this.p2.y},Object.assign({},this.attributes)).clip1(t)}clip2(t){let i=this.intersection(t);return isFinite(i)&&i>0&&i<1&&(this.p2.x=this.p1.x+i*(this.p2.x-this.p1.x),this.p2.y=this.p1.y+i*(this.p2.y-this.p1.y)),this}clipped2(t){return new e({x:this.p1.x,y:this.p1.y},{x:this.p2.x,y:this.p2.y},Object.assign({},this.attributes)).clip2(t)}reach1(t){let i=this.intersection(t);if(isFinite(i)){let t=this.getParametricPoint(i);this.p1.x=t.x,this.p1.y=t.y}return this}reached1(t){return new e({x:this.p1.x,y:this.p1.y},{x:this.p2.x,y:this.p2.y},Object.assign({},this.attributes)).reach1(t)}reach2(t){let i=this.intersection(t);if(isFinite(i)){let t=this.getParametricPoint(i);this.p2.x=t.x,this.p2.y=t.y}return this}reached2(t){return new e({x:this.p1.x,y:this.p1.y},{x:this.p2.x,y:this.p2.y},Object.assign({},this.attributes)).reach2(t)}point(t){return{x:this.p1.x+t*(this.p2.x-this.p1.x),y:this.p1.y+t*(this.p2.y-this.p1.y)}}}i.Edge2D=e},728:(t,i,e)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Engine=void 0;const s=e(845),h=e(4);i.Engine=class{constructor(t,i){this.minTime=1e-6;let e=0;t.forEach((t=>{t.attributes.id=(e++).toString()})),i.forEach((t=>{t.attributes.id=(e++).toString()})),this.state={numElements:e,actors:t,elements:i}}getActors(){return this.state.actors}getElements(){return this.state.elements}pushActor(t){t.attributes.id=this.state.numElements++,this.state.actors.push(t)}pushElement(t){t.attributes.id=this.state.numElements++,this.state.elements.push(t)}popActorById(t){return this.state.actors.filter((i=>i.attributes.id===t))[0]}popElementById(t){return this.state.elements.filter((i=>i.attributes.id===t))[0]}determineNextCollisions(){let t=[{t:999999999,Object1:null,Object2:null}];return this.state.actors.forEach(((i,e)=>{for(let s=e+1;s<this.state.actors.length;s++){let e=Math.min(...i.timeToCollideWithBall(this.state.actors[s]));e===t[0].t&&t.push({t:e,Object1:i,Object2:this.state.actors[s]}),e<t[0].t&&e>this.minTime&&(t=[{t:e,Object1:i,Object2:this.state.actors[s]}])}this.state.elements.forEach((e=>{let s=Math.min(...i.timeToCollideWithEdge(e));s===t[0].t&&t.push({t:s,Object1:i,Object2:e}),s<t[0].t&&s>this.minTime&&(t=[{t:s,Object1:i,Object2:e}]),s=Math.min(...i.timeToCollideWithPoint(e.getP1())),s===t[0].t&&t.push({t:s,Object1:i,Object2:e.getP1()}),s<t[0].t&&s>this.minTime&&(t=[{t:s,Object1:i,Object2:e.getP1()}]),s=Math.min(...i.timeToCollideWithPoint(e.getP2())),s===t[0].t&&t.push({t:s,Object1:i,Object2:e.getP2()}),s<t[0].t&&s>this.minTime&&(t=[{t:s,Object1:i,Object2:e.getP2()}])}))})),t}moveActors(t){let i=this.determineNextCollisions();for(;i[0].t<t&&i[0].t>0;)this.state.actors.forEach((t=>t.move(i[0].t))),i.forEach((t=>{var i,e;t.Object2 instanceof h.Ball?t.Object1.deflectWithBall(t.Object2):t.Object2 instanceof s.Edge2D?t.Object1.slideOnEdge(t.Object2):(null===(i=t.Object2)||void 0===i?void 0:i.x)&&(null===(e=t.Object2)||void 0===e?void 0:e.y)&&t.Object1.deflectWithPoint(t.Object2)})),t-=i[0].t,i=this.determineNextCollisions();this.state.actors.forEach((i=>i.move(t)))}}}},i={};function e(s){var h=i[s];if(void 0!==h)return h.exports;var a=i[s]={exports:{}};return t[s](a,a.exports,e),a.exports}(()=>{const t=e(863),i=e(728),s=e(4),h=e(845);function a(t,i){let e=Date.now(),s=(e-i)/1e3,o=new h.Edge2D({x:0,y:0},{x:-t.playerDirection.y(),y:t.playerDirection.x()}).size(s*t.velocity.x()),r=new h.Edge2D({x:0,y:0},{x:t.playerDirection.x(),y:t.playerDirection.y()}).size(s*t.velocity.y()).add(o);t.playerBall.relocate(t.playerDirection.getP1().x,t.playerDirection.getP1().y),t.playerBall.velocity.setP1(t.playerDirection.getP1()),t.playerBall.velocity.setP2({x:t.playerBall.velocity.p1.x+r.x(),y:t.playerBall.velocity.p1.y+r.y()});let c=t.playerBall.getLocation().x,l=t.playerBall.getLocation().y;t.engine.moveActors(s),c=t.playerBall.getLocation().x-c,l=t.playerBall.getLocation().y-l,t.playerDirection.reposition({x:t.playerDirection.getP1().x+c,y:t.playerDirection.getP1().y+l}),t.virtualScreen.reposition({x:t.virtualScreen.getP1().x+c,y:t.virtualScreen.getP1().y+l}),t.playerDirection.rotate(s*t.angularVelocity),t.virtualScreen.pivot(s*t.angularVelocity,t.playerDirection.getP1()),t.playerDirection.rotate(s*t.mouseAngularVelocity),t.virtualScreen.pivot(s*t.mouseAngularVelocity,t.playerDirection.getP1()),t.mouseAngularVelocity=0,function(t){t.ctx.clearRect(0,0,t.ui.canvas.width,t.ui.canvas.height);for(let i=0;i<.5*t.ui.canvas.height;i++){let e=i/(.5*t.ui.canvas.height);t.ctx.strokeStyle=n("#0000ffff",e),t.ctx.beginPath(),t.ctx.moveTo(0,i),t.ctx.lineTo(t.ui.canvas.width,i),t.ctx.stroke(),t.ctx.closePath()}for(let i=0;i<=.5*t.ui.canvas.height;i++){let e=i/(.5*t.ui.canvas.height);t.ctx.strokeStyle=n("#ffaa00ff",e),t.ctx.beginPath(),t.ctx.moveTo(0,t.ui.canvas.height-i),t.ctx.lineTo(t.ui.canvas.width,t.ui.canvas.height-i),t.ctx.stroke(),t.ctx.closePath()}let i=[];for(let e=0;e<t.ui.canvas.width;e++){let s=e/t.ui.canvas.width,a={d:99999999,c:"",ray:null},o=t.virtualScreen.getParametricPoint(s),r=new h.Edge2D(t.playerDirection.getP1(),o);if(t.walls.forEach((t=>{let i=r.intersection(t),e=t.intersection(r);if(isFinite(i)&&i>0&&isFinite(e)&&e>=0&&e<=1){let i=r.reached2(t),s=i.mm();s<a.d&&(a.d=s,a.c=t.attributes.color,a.ray=i,0!=e&&1!=e||(a.c="black"))}})),""!==a.c){a.d=Math.sqrt(a.d);let s=.5*t.ui.canvas.height/a.d,h=.5*(1-1/a.d);h>1&&(h=1),t.ctx.strokeStyle=n(a.c,h),t.ctx.beginPath(),t.ctx.moveTo(e,.5*t.ui.canvas.height-s),t.ctx.lineTo(e,.5*t.ui.canvas.height+s),t.ctx.stroke(),i.push(a.ray)}}}(t),requestAnimationFrame((()=>a(t,e)))}function n(t,i){let e=parseInt(t.substring(1,3),16),s=parseInt(t.substring(3,5),16),h=parseInt(t.substring(5,7),16),a=parseInt(t.substring(7,9),16);return e=Math.floor(e*(1-i)),s=Math.floor(s*(1-i)),h=Math.floor(h*(1-i)),"#"+e.toString(16).padStart(2,"0")+s.toString(16).padStart(2,"0")+h.toString(16).padStart(2,"0")+a.toString(16).padStart(2,"0")}customElements.define("touch-pad",t.TouchPad),window.main=()=>{try{let t={canvas:document.getElementById("myCanvas"),controlPanel:document.getElementById("control-panel"),overlay:document.getElementById("overlay"),outputPanel:document.getElementById("output-panel"),touchpad1:document.getElementById("touch-pad1"),touchpad2:document.getElementById("touch-pad2")};t.canvas.width=t.canvas.parentElement.clientWidth,t.canvas.height=t.canvas.parentElement.clientHeight,new ResizeObserver((i=>{t.canvas.width=t.canvas.clientWidth,t.canvas.height=t.canvas.clientHeight})).observe(t.canvas);let e=[{x:10,y:-10},{x:10,y:10},{x:-10,y:10},{x:-10,y:-10},{x:.5,y:-7.5},{x:7.5,y:-7.5},{x:7.5,y:7.5},{x:-7.5,y:7.5},{x:-7.5,y:-7.5},{x:-.5,y:-7.5},{x:.5,y:4},{x:5,y:5},{x:0,y:-4},{x:-5,y:5},{x:-.5,y:4}],n=[new h.Edge2D(e[0],e[1],{color:"#"+((Math.floor(16777215*Math.random())<<8|255)>>>0).toString(16).padStart(8,"0")}),new h.Edge2D(e[1],e[2],{color:"#"+((Math.floor(16777215*Math.random())<<8|255)>>>0).toString(16).padStart(8,"0")}),new h.Edge2D(e[2],e[3],{color:"#"+((Math.floor(16777215*Math.random())<<8|255)>>>0).toString(16).padStart(8,"0")}),new h.Edge2D(e[3],e[0],{color:"#"+((Math.floor(16777215*Math.random())<<8|255)>>>0).toString(16).padStart(8,"0")}),new h.Edge2D(e[4],e[5],{color:"#"+((Math.floor(16777215*Math.random())<<8|255)>>>0).toString(16).padStart(8,"0")}),new h.Edge2D(e[5],e[6],{color:"#"+((Math.floor(16777215*Math.random())<<8|255)>>>0).toString(16).padStart(8,"0")}),new h.Edge2D(e[6],e[7],{color:"#"+((Math.floor(16777215*Math.random())<<8|255)>>>0).toString(16).padStart(8,"0")}),new h.Edge2D(e[7],e[8],{color:"#"+((Math.floor(16777215*Math.random())<<8|255)>>>0).toString(16).padStart(8,"0")}),new h.Edge2D(e[8],e[9],{color:"#"+((Math.floor(16777215*Math.random())<<8|255)>>>0).toString(16).padStart(8,"0")}),new h.Edge2D(e[10],e[11],{color:"#"+((Math.floor(16777215*Math.random())<<8|255)>>>0).toString(16).padStart(8,"0")}),new h.Edge2D(e[11],e[12],{color:"#"+((Math.floor(16777215*Math.random())<<8|255)>>>0).toString(16).padStart(8,"0")}),new h.Edge2D(e[12],e[13],{color:"#"+((Math.floor(16777215*Math.random())<<8|255)>>>0).toString(16).padStart(8,"0")}),new h.Edge2D(e[13],e[14],{color:"#"+((Math.floor(16777215*Math.random())<<8|255)>>>0).toString(16).padStart(8,"0")})],o=new h.Edge2D({x:0,y:0},{x:1,y:0},{directed:!0}).scale(10),r=o.rotated(.5*Math.PI);r.reposition(o.getP2()).reposition({x:r.getP1().x,y:-5});let c=t.canvas.getContext("2d"),l=new h.Edge2D({x:0,y:0},{x:0,y:0}),y=new s.Ball({x:0,y:0},{x:0,y:0},{x:0,y:0},.25,10),d=new i.Engine([y],n),p={virtualScreen:r,playerDirection:o,velocity:l,playerBall:y,engine:d,angularVelocity:0,mouseAngularVelocity:0,walls:n,ui:t,ctx:c};t.touchpad1.subscribe(((t,i)=>l.setP2({x:200*t,y:200*i}))),t.touchpad2.subscribe(((t,i)=>p.angularVelocity=.5*t*Math.PI)),document.addEventListener("keydown",(t=>{switch(t.key){case"w":p.velocity.setP2({x:p.velocity.getP2().x,y:200});break;case"s":p.velocity.setP2({x:p.velocity.getP2().x,y:-200});break;case"a":p.velocity.setP2({x:-200,y:p.velocity.getP2().y});break;case"d":p.velocity.setP2({x:200,y:p.velocity.getP2().y})}})),document.addEventListener("keyup",(t=>{switch(t.key){case"w":case"s":p.velocity.setP2({x:p.velocity.getP2().x,y:0});break;case"a":case"d":p.velocity.setP2({x:0,y:p.velocity.getP2().y})}}));let x=.5*t.canvas.clientWidth;document.addEventListener("mousemove",(t=>{let i=t.clientX-x;x=t.clientX,p.mouseAngularVelocity=.5*i})),a(p,Date.now()),"ontouchstart"in document.documentElement&&console.log("test")}catch(t){alert(t)}}})()})();